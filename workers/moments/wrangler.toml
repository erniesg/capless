name = "capless-moments"
main = "src/index.ts"
compatibility_date = "2025-01-20"
compatibility_flags = ["nodejs_compat"]

# Environment bindings
[[r2_buckets]]
binding = "R2"
bucket_name = "capless"
preview_bucket_name = "capless-preview"

[[vectorize]]
binding = "VECTORIZE"
index_name = "capless-moments"

# Redis for caching (commented out for local dev - causes issues)
# [[unsafe.bindings]]
# name = "REDIS"
# type = "ratelimit"

# Environment variables (secrets set via wrangler secret put)
# OPENAI_API_KEY - set via: wrangler secret put OPENAI_API_KEY
# UPSTASH_REDIS_REST_URL - set via: wrangler secret put UPSTASH_REDIS_REST_URL
# UPSTASH_REDIS_REST_TOKEN - set via: wrangler secret put UPSTASH_REDIS_REST_TOKEN

[vars]
ENVIRONMENT = "production"
OPENAI_MODEL = "gpt-4o"
OPENAI_EMBEDDING_MODEL = "text-embedding-3-small"
MAX_MOMENTS_PER_TRANSCRIPT = 20
MIN_VIRALITY_SCORE = 5.0

[dev]
port = 8789
